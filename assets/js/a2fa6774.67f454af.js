"use strict";(self.webpackChunkdocu=self.webpackChunkdocu||[]).push([[596],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=s(n),m=r,h=d["".concat(c,".").concat(m)]||d[m]||u[m]||o;return n?a.createElement(h,l(l({ref:t},p),{},{components:n})):a.createElement(h,l({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var s=2;s<o;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},55403:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>s});var a=n(87462),r=(n(67294),n(3905));const o={},l="Fauna",i={unversionedId:"integrations/sources/fauna",id:"integrations/sources/fauna",title:"Fauna",description:"This page guides you through setting up a Fauna source.",source:"@site/../docs/integrations/sources/fauna.md",sourceDirName:"integrations/sources",slug:"/integrations/sources/fauna",permalink:"/integrations/sources/fauna",draft:!1,editUrl:"https://github.com/airbytehq/airbyte/blob/master/docs/../docs/integrations/sources/fauna.md",tags:[],version:"current",frontMatter:{},sidebar:"mySidebar",previous:{title:"Faker",permalink:"/integrations/sources/faker"},next:{title:"Files",permalink:"/integrations/sources/file"}},c={},s=[{value:"Preliminary setup",id:"preliminary-setup",level:2},{value:"Full sync",id:"full-sync",level:2},{value:"Incremental sync",id:"incremental-sync",level:2},{value:"Export formats",id:"export-formats",level:2},{value:"Ref types",id:"ref-types",level:3},{value:"Changelog",id:"changelog",level:2}],p={toc:s};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"fauna"},"Fauna"),(0,r.kt)("p",null,"This page guides you through setting up a ",(0,r.kt)("a",{parentName:"p",href:"https://fauna.com/"},"Fauna")," source."),(0,r.kt)("h1",{id:"overview"},"Overview"),(0,r.kt)("p",null,"The Fauna source supports the following sync modes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Full Sync")," - exports all the data from a Fauna collection."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Incremental Sync")," - exports data incrementally from a Fauna collection.")),(0,r.kt)("p",null,"You need to create a separate source per collection that you want to export."),(0,r.kt)("h2",{id:"preliminary-setup"},"Preliminary setup"),(0,r.kt)("p",null,"Enter the domain of the collection's database that you are exporting. The URL can be found in\n",(0,r.kt)("a",{parentName:"p",href:"https://docs.fauna.com/fauna/current/learn/understanding/region_groups#how-to-use-region-groups"},"the docs"),"."),(0,r.kt)("h2",{id:"full-sync"},"Full sync"),(0,r.kt)("p",null,"Follow these steps if you want this connection to perform a full sync."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Create a role that can read the collection that you are exporting. You can create the role in the ",(0,r.kt)("a",{parentName:"li",href:"https://dashboard.fauna.com/"},"Dashboard")," or the ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/fauna/fauna-shell"},"fauna shell")," with the following query:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'CreateRole({\n  name: "airbyte-readonly",\n  privileges: [\n    {\n      resource: Collections(),\n      actions: { read: true }\n    },\n    {\n      resource: Indexes(),\n      actions: { read: true }\n    },\n    {\n      resource: Collection("COLLECTION_NAME"),\n      actions: { read: true }\n    }\n  ],\n})\n')),(0,r.kt)("p",null,"Replace ",(0,r.kt)("inlineCode",{parentName:"p"},"COLLECTION_NAME")," with the name of the collection configured for this connector. If you'd like to sync\nmultiple collections, add an entry for each additional collection you'd like to sync. For example, to sync\n",(0,r.kt)("inlineCode",{parentName:"p"},"users")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"products"),", run this query instead:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'CreateRole({\n  name: "airbyte-readonly",\n  privileges: [\n    {\n      resource: Collections(),\n      actions: { read: true }\n    },\n    {\n      resource: Indexes(),\n      actions: { read: true }\n    },\n    {\n      resource: Collection("users"),\n      actions: { read: true }\n    },\n    {\n      resource: Collection("products"),\n      actions: { read: true }\n    }\n  ],\n})\n')),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Create a key with that role. You can create a key using this query:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'CreateKey({\n  name: "airbyte-readonly",\n  role: Role("airbyte-readonly"),\n})\n')),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Copy the ",(0,r.kt)("inlineCode",{parentName:"li"},"secret")," output by the ",(0,r.kt)("inlineCode",{parentName:"li"},"CreateKey"),' command and enter that as the "Fauna Secret" on the left.\n',(0,r.kt)("strong",{parentName:"li"},"Important"),": The secret is only ever displayed once. If you lose it, you would have to create a new key.")),(0,r.kt)("h2",{id:"incremental-sync"},"Incremental sync"),(0,r.kt)("p",null,"Follow these steps if you want this connection to perform incremental syncs."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},'Create the "Incremental Sync Index". This allows the connector to perform incremental syncs. You can create the index with the ',(0,r.kt)("a",{parentName:"li",href:"https://github.com/fauna/fauna-shell"},"fauna shell")," or in the ",(0,r.kt)("a",{parentName:"li",href:"https://dashboard.fauna.com/"},"Dashboard")," with the following query:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'CreateIndex({\n  name: "INDEX_NAME",\n  source: Collection("COLLECTION_NAME"),\n  terms: [],\n  values: [\n    { "field": "ts" },\n    { "field": "ref" }\n  ]\n})\n')),(0,r.kt)("p",null,"Replace ",(0,r.kt)("inlineCode",{parentName:"p"},"COLLECTION_NAME")," with the name of the collection configured for this connector.\nReplace ",(0,r.kt)("inlineCode",{parentName:"p"},"INDEX_NAME")," with the name that you configured for the Incremental Sync Index."),(0,r.kt)("p",null,"Repeat this step for every collection you'd like to sync."),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Create a role that can read the collection, the index, and the metadata of all indexes. It needs access to index metadata in order to validate the index settings. You can create the role with this query:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'CreateRole({\n  name: "airbyte-readonly",\n  privileges: [\n    {\n      resource: Collections(),\n      actions: { read: true }\n    },\n    {\n      resource: Indexes(),\n      actions: { read: true }\n    },\n    {\n      resource: Collection("COLLECTION_NAME"),\n      actions: { read: true }\n    },\n    {\n      resource: Index("INDEX_NAME"),\n      actions: { read: true }\n    }\n  ],\n})\n')),(0,r.kt)("p",null,"Replace ",(0,r.kt)("inlineCode",{parentName:"p"},"COLLECTION_NAME")," with the name of the collection configured for this connector.\nReplace ",(0,r.kt)("inlineCode",{parentName:"p"},"INDEX_NAME")," with the name that you configured for the Incremental Sync Index."),(0,r.kt)("p",null,"If you'd like to sync multiple collections, add an entry for every collection and index\nyou'd like to sync. For example, to sync ",(0,r.kt)("inlineCode",{parentName:"p"},"users")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"products")," with Incremental Sync, run\nthe following query:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'CreateRole({\n  name: "airbyte-readonly",\n  privileges: [\n    {\n      resource: Collections(),\n      actions: { read: true }\n    },\n    {\n      resource: Indexes(),\n      actions: { read: true }\n    },\n    {\n      resource: Collection("users"),\n      actions: { read: true }\n    },\n    {\n      resource: Index("users-ts"),\n      actions: { read: true }\n    },\n    {\n      resource: Collection("products"),\n      actions: { read: true }\n    },\n    {\n      resource: Index("products-ts"),\n      actions: { read: true }\n    }\n  ],\n})\n')),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Create a key with that role. You can create a key using this query:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'CreateKey({\n  name: "airbyte-readonly",\n  role: Role("airbyte-readonly"),\n})\n')),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"Copy the ",(0,r.kt)("inlineCode",{parentName:"li"},"secret")," output by the ",(0,r.kt)("inlineCode",{parentName:"li"},"CreateKey"),' command and enter that as the "Fauna Secret" on the left.\n',(0,r.kt)("strong",{parentName:"li"},"Important"),": The secret is only ever displayed once. If you lose it, you would have to create a new key.")),(0,r.kt)("h2",{id:"export-formats"},"Export formats"),(0,r.kt)("p",null,"This section captures export formats for all special case data stored in Fauna. This list is exhaustive."),(0,r.kt)("p",null,"Note that the ",(0,r.kt)("inlineCode",{parentName:"p"},"ref"),' column in the exported database contains only the document ID from each document\'s\nreference (or "ref"). Since only one collection is involved in each connector configuration, it is\ninferred that the document ID refers to a document within the synced collection.'),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Fauna Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Format"),(0,r.kt)("th",{parentName:"tr",align:null},"Note"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://docs.fauna.com/fauna/current/learn/understanding/types#ref"},"Document Ref")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'{ id: "id", "collection": "collection-name", "type": "document" }')),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://docs.fauna.com/fauna/current/learn/understanding/types#ref"},"Other Ref")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'{ id: "id", "type": "ref-type" }')),(0,r.kt)("td",{parentName:"tr",align:null},"This includes all other refs, listed below.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://docs.fauna.com/fauna/current/learn/understanding/types#byte"},"Byte Array")),(0,r.kt)("td",{parentName:"tr",align:null},"base64 url formatting"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://docs.fauna.com/fauna/current/learn/understanding/types#date"},"Timestamp")),(0,r.kt)("td",{parentName:"tr",align:null},"date-time, or an iso-format timestamp"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://docs.fauna.com/fauna/current/learn/understanding/types#set"},"Query, SetRef")),(0,r.kt)("td",{parentName:"tr",align:null},"a string containing the wire protocol of this value"),(0,r.kt)("td",{parentName:"tr",align:null},"The wire protocol is not documented.")))),(0,r.kt)("h3",{id:"ref-types"},"Ref types"),(0,r.kt)("p",null,"Every ref is serialized as a JSON object with 2 or 3 fields, as listed above. The ",(0,r.kt)("inlineCode",{parentName:"p"},"type")," field must be\none of these strings:\n|                                    Reference Type                                       |    ",(0,r.kt)("inlineCode",{parentName:"p"},"type")," string    |\n| --------------------------------------------------------------------------------------- | ------------------- |\n| Document                                                                                | ",(0,r.kt)("inlineCode",{parentName:"p"},'"document"'),"        |\n| ",(0,r.kt)("a",{parentName:"p",href:"https://docs.fauna.com/fauna/current/api/fql/functions/collection"},"Collection"),"         | ",(0,r.kt)("inlineCode",{parentName:"p"},'"collection"'),"      |\n| ",(0,r.kt)("a",{parentName:"p",href:"https://docs.fauna.com/fauna/current/api/fql/functions/database"},"Database"),"             | ",(0,r.kt)("inlineCode",{parentName:"p"},'"database"'),"        |\n| ",(0,r.kt)("a",{parentName:"p",href:"https://docs.fauna.com/fauna/current/api/fql/functions/iindex"},"Index"),"                  | ",(0,r.kt)("inlineCode",{parentName:"p"},'"index"'),"           |\n| ",(0,r.kt)("a",{parentName:"p",href:"https://docs.fauna.com/fauna/current/api/fql/functions/function"},"Function"),"             | ",(0,r.kt)("inlineCode",{parentName:"p"},'"function"'),"        |\n| ",(0,r.kt)("a",{parentName:"p",href:"https://docs.fauna.com/fauna/current/api/fql/functions/role"},"Role"),"                     | ",(0,r.kt)("inlineCode",{parentName:"p"},'"role"'),"            |\n| ",(0,r.kt)("a",{parentName:"p",href:"https://docs.fauna.com/fauna/current/api/fql/functions/accessprovider"},"AccessProvider")," | ",(0,r.kt)("inlineCode",{parentName:"p"},'"access_provider"')," |\n| ",(0,r.kt)("a",{parentName:"p",href:"https://docs.fauna.com/fauna/current/api/fql/functions/keys"},"Key"),"                      | ",(0,r.kt)("inlineCode",{parentName:"p"},'"key"'),"             |\n| ",(0,r.kt)("a",{parentName:"p",href:"https://docs.fauna.com/fauna/current/api/fql/functions/tokens"},"Token"),"                  | ",(0,r.kt)("inlineCode",{parentName:"p"},'"token"'),"           |\n| ",(0,r.kt)("a",{parentName:"p",href:"https://docs.fauna.com/fauna/current/api/fql/functions/credentials"},"Credential"),"        | ",(0,r.kt)("inlineCode",{parentName:"p"},'"credential"'),"      |"),(0,r.kt)("p",null,"For all other refs (for example if you stored the result of ",(0,r.kt)("inlineCode",{parentName:"p"},"Collections()"),"), the ",(0,r.kt)("inlineCode",{parentName:"p"},"type")," must be ",(0,r.kt)("inlineCode",{parentName:"p"},'"unknown"'),".\nThere is a difference between a specific collection ref (retrieved with ",(0,r.kt)("inlineCode",{parentName:"p"},'Collection("name")'),"), and all the reference\nto all collections (retrieved with ",(0,r.kt)("inlineCode",{parentName:"p"},"Collections()"),"). This is why the ",(0,r.kt)("inlineCode",{parentName:"p"},"type")," is ",(0,r.kt)("inlineCode",{parentName:"p"},'"unknown"')," for ",(0,r.kt)("inlineCode",{parentName:"p"},"Collections()"),",\nbut not for ",(0,r.kt)("inlineCode",{parentName:"p"},'Collection("name")')),(0,r.kt)("p",null,"To select the document ID from a ref, add ",(0,r.kt)("inlineCode",{parentName:"p"},'"id"'),' to the "Path" of the additional column. For example, if "Path"\nis ',(0,r.kt)("inlineCode",{parentName:"p"},'["data", "parent"]'),', change the "Path" to ',(0,r.kt)("inlineCode",{parentName:"p"},'["data", "parent", "id"]'),"."),(0,r.kt)("p",null,"To select the collection name, add ",(0,r.kt)("inlineCode",{parentName:"p"},'"collection", "id"'),' to the "Path" of the additional column. For example, if\n"Path" is ',(0,r.kt)("inlineCode",{parentName:"p"},'["data", "parent"]'),', change the "Path" to ',(0,r.kt)("inlineCode",{parentName:"p"},'["data", "parent", "collection", "id"]'),". Internally, the\nFQL ",(0,r.kt)("a",{parentName:"p",href:"https://docs.fauna.com/fauna/current/api/fql/functions/select"},(0,r.kt)("inlineCode",{parentName:"a"},"Select"))," is used."),(0,r.kt)("h2",{id:"changelog"},"Changelog"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Version"),(0,r.kt)("th",{parentName:"tr",align:null},"Date"),(0,r.kt)("th",{parentName:"tr",align:null},"Pull Request"),(0,r.kt)("th",{parentName:"tr",align:null},"Subject"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"0.1.0"),(0,r.kt)("td",{parentName:"tr",align:null},"2022-08-03"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/airbytehq/airbyte/pull/15274"},"15274")),(0,r.kt)("td",{parentName:"tr",align:null},"Add Fauna Source")))))}u.isMDXComponent=!0}}]);